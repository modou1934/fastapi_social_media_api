# render.yaml - Nel root del progetto
services:
  # Web Service (la tua FastAPI app)
  - type: web
    name: fastapi_social_media_api            # Nome del servizio
    env: python                        # Ambiente Python
    plan: free                         # Piano gratuito
    buildCommand: "pip install -r requirements.txt"    # Build
    startCommand: "uvicorn app.main:app --host 0.0.0.0 --port $PORT" # Avvia la tua app
    
    # Environment Variables
    envVars:
      - key: ENVIRONMENT
        value: production
      - key: DATABASE_URL
        fromDatabase:
          name: postgres       # Nome del database (crealo prima)
          property: connectionString   # Internal URL automatica
    
    # Auto-deploy su push GitHub
    autoDeploy: true
    envBranchName: main                 # Branch da deployare

  # Database PostgreSQL
  - type: pgsql
    name: postgres             # Nome del database
    disk:
      name: db-data
      mountPath: /var/lib/postgresql/data
      sizeGB: 1                       # 1GB gratuito
    plan: free                         # Piano gratuito (90 giorni)
